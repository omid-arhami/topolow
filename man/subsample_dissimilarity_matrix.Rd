% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{subsample_dissimilarity_matrix}
\alias{subsample_dissimilarity_matrix}
\title{Subsample Dissimilarity Matrix with Connectivity Guarantee}
\usage{
subsample_dissimilarity_matrix(
  dissimilarity_matrix,
  sample_size,
  max_attempts = 5,
  min_completeness = 0.1,
  random_seed = NULL,
  verbose = FALSE,
  preserve_order = FALSE
)
}
\arguments{
\item{dissimilarity_matrix}{Square symmetric dissimilarity matrix.}

\item{sample_size}{Integer. Target number of points to sample.}

\item{max_attempts}{Integer. Maximum number of sampling attempts before
giving up. Default: 5}

\item{min_completeness}{Numeric. Minimum acceptable network completeness
(0-1). Default: 0.10. Used for warnings, not hard requirement.}

\item{random_seed}{Integer or NULL. If provided, sets the random seed for reproducibility.}

\item{verbose}{Logical. Print progress messages. Default: FALSE.}

\item{preserve_order}{Logical. If TRUE, the selected indices are sorted to maintain the
original row/column order of the input matrix. If FALSE (default), indices are
returned in random order as sampled. Set to TRUE when downstream analyses depend
on specific point ordering.}
}
\value{
A list containing:
\item{subsampled_matrix}{Matrix. The subsampled dissimilarity matrix.}
\item{selected_indices}{Integer vector. Indices of selected points from
the original matrix.}
\item{selected_names}{Character vector or NULL. Names of selected points
(if original matrix had row/column names).}
\item{is_connected}{Logical. Whether the final subsample is connected.}
\item{n_components}{Integer. Number of connected components in final subsample.}
\item{completeness}{Numeric. Network completeness of final subsample (0-1).}
\item{attempt_number}{Integer. Which attempt succeeded.}
}
\description{
Randomly samples a subset of points from a dissimilarity matrix, ensuring
the resulting submatrix forms a connected graph.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates inputs and checks if subsampling is necessary
\item Attempts to sample \code{sample_size} points randomly
\item Checks if the subsample forms a connected graph using
\code{\link{check_matrix_connectivity}}
\item If not connected, retries
\item Returns the connected subsample or stops with an error if unsuccessful
}

\strong{Why connectivity matters}: A disconnected graph has isolated groups of
points with no observed dissimilarities between groups. The algorithm
cannot determine the relative positions of disconnected components,
leading to arbitrary and meaningless results.
}
\examples{
# Create a well-connected matrix
n <- 100
coords <- matrix(rnorm(n * 3), ncol = 3)
dist_mat <- as.matrix(dist(coords))

# Subsample to 30 points
result <- subsample_dissimilarity_matrix(
  dissimilarity_matrix = dist_mat,
  sample_size = 30,
  random_seed = 123,
  verbose = TRUE
)

print(result$is_connected)
print(dim(result$subsampled_matrix))

}
\seealso{
\code{\link{check_matrix_connectivity}} for connectivity checking,
}
