% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core.R
\name{topolow_Smith_obj}
\alias{topolow_Smith_obj}
\title{Smith variant of TopoLow algorithm}
\usage{
topolow_Smith_obj(
  distance_matrix,
  ndim,
  max_iter,
  k0,
  cooling_rate,
  c_repulsion,
  relative_epsilon = 1e-04,
  convergence_counter = 10,
  initial_positions = NULL,
  write_positions_to_csv = TRUE,
  verbose = TRUE,
  trace_sse = TRUE,
  ofs = 1
)
}
\arguments{
\item{distance_matrix}{Matrix. Square, symmetric distance matrix. Can contain NA values
for missing measurements and character strings with < or > prefixes for thresholded
measurements.}

\item{ndim}{Integer. Number of dimensions for the embedding space.}

\item{max_iter}{Integer. Maximum number of optimization iterations.}

\item{k0}{Numeric. Initial spring constant controlling spring forces.}

\item{cooling_rate}{Numeric. Rate of spring constant decay per iteration (0 < cooling_rate < 1).}

\item{c_repulsion}{Numeric. Repulsion constant controlling repulsive forces.}

\item{relative_epsilon}{Numeric. Convergence threshold for relative change in error.
Default is 1e-4.}

\item{convergence_counter}{Integer. Number of iterations below threshold before declaring
convergence. Default is 10.}

\item{initial_positions}{Matrix or NULL. Optional starting coordinates. If NULL,
random initialization is used. Matrix should have nrow = nrow(distance_matrix)
and ncol = ndim.}

\item{write_positions_to_csv}{Logical. Whether to save point positions to CSV file.
Default is TRUE.}

\item{verbose}{Logical. Whether to print progress messages. Default is TRUE.}

\item{trace_sse}{Logical. Whether to track sum of squared errors. Default is TRUE.}

\item{ofs}{Numeric. Offset parameter for threshold calculations. Default is 1.}
}
\value{
A list of class "topolow" containing the same elements as topolow_full() plus:
\itemize{
\item variant: Character string "smith" indicating the algorithm variant
\item parameters$ofs: The offset parameter used
}
}
\description{
A variant of the TopoLow algorithm specifically designed for HI assay data, using
modified force calculations with sigmoid thresholding as described in Smith et al.
This version handles threshold measurements differently from the standard algorithm.
}
\details{
The key differences from topolow_full are:
\itemize{
\item Modified force calculation for threshold measurements using sigmoid function
\item Offset parameter for threshold calculations
\item Specialized handling of HI assay-style measurements
}

Like Topolow algorithm, this variant is particularly suited for data where:
\itemize{
\item Measurements represent binding affinities
\item Many measurements are thresholded (< or >)
\item True distances follow certain biological constraints
}

Valid parameter ranges and constraints:
\itemize{
\item ndim: Positive integer, typically 2-20. Higher dimensions increase computational cost
\item k0: Initial spring constant, positive numeric > 0. Typical range: 0.1-30
Controls initial force strength
\item cooling_rate: Spring decay rate, numeric between 0 and 1. Typical range: 0.0001-0.1
Controls how quickly spring forces weaken
\item c_repulsion: Repulsion constant, positive numeric > 0. Typical range: 0.00001-0.2
Controls repulsive force strength
\item relative_epsilon: Positive numeric, typically 1e-6 to 1e-2
Smaller values require more iterations but give higher precision
\item convergence_counter: Positive integer, typically 5-20
Higher values ensure more stable convergence
\item ofs: Numeric offset parameter > 0. Typical range: 0.5-2
Controls threshold sensitivity
}
}
\examples{
# Create a simple distance matrix with thresholds
dist_mat <- matrix(c(0, ">2", 3, ">2", 0, 4, 3, 4, 0), nrow=3)

# Run Smith variant
result <- topolow_Smith_obj(dist_mat, ndim=2, max_iter=1000, 
                           k0=1.0, cooling_rate=0.001, c_repulsion=0.1)
                           
}
\references{
Smith, D. J., et al. (2004) "Mapping the Antigenic and Genetic Evolution of
Influenza Virus" Science, 305(5682), 371-376.
}
\seealso{
\code{\link{topolow_full}} for the standard algorithm version
}
